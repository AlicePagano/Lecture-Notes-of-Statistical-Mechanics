\documentclass[../main/main.tex]{subfiles}

\newdate{date}{30}{10}{2019}


\begin{document}

\marginpar{ \textbf{Lecture 7.} \\  \displaydate{date}. \\ Compiled:  \today.}
\subsection{Transfer Matrix method}

Given the Hamiltonian discussed in (\ref{sec:6_1}) \footnote{The choice of boundary conditions becomes irrelevant in the thermodynamic limit, \( N \rightarrow \infty  \).} we can write the corresponding partition function in the following symmetric form:
\begin{equation*}
  Z_N (k,h) = \sum_{S_1 = \pm 1}^{} \sum_{S_2 = \pm 1}^{}  \dots \sum_{S_N = \pm 1}^{}
  \qty[e^{K S_1 S_2 + \frac{h}{2}(S_1+S_2)} ] \qty[e^{K S_2 S_3 + \frac{h}{2}(S_2+S_3)} ] \dots \qty[e^{K S_N S_1 + \frac{h}{2}(S_N+S_1)} ]
\end{equation*}
We want to write the partition function in a form similarly to \( \sum_{j}^{}  M_{ij} P_{jk} \).
Note that, in the previous form \( Z_N \) can be written as a product of matrices
\begin{equation}
\begin{split}
Z_N (h,k)  &= \sum_{S_1 = \pm 1}^{} \dots \sum_{S_N = \pm 1}^{} \prod_{i=1}^{N} \exp [K S_i S_{i+1} + \frac{h}{2} (S_i + S_{i+1})] \\
& =  \sum_{S_1 = \pm 1}^{} \dots \sum_{S_N = \pm 1}^{} \bra{S_1} \mathbb{T} \ket{S_2} \bra{S_2}  \mathbb{T} \ket{S_3} \dots \bra{S_N}  \mathbb{T} \ket{S_1}
\end{split}
\end{equation}
where \( \mathbb{T} \) is a \( 2 \times 2 \)  matrix defined as
\begin{equation}
  \bra{S} \mathbb{T} \ket{S'} = \exp [K S S' + \frac{h}{2} (S+S')]
\end{equation}
\begin{remark}
  Note that the labels of the matrix corresponds to the values of \( S_i \). Hence, its dimension depends on the number of possible values a spin \( S_i \) can assume.
  It can also depends on how many spins are involved in the interacting terms that are present in the Hamiltonian (\( k_{LL} \sum_{}^{} S_i S_{i+1} S_{i+2} S_{i+3}  \)).
\end{remark}
 For the Ising model, we have \( S_i = \pm 1 \) and nearest neighbour interaction implies that we have two values and that \( \mathbb{T} \) is a \( 2 \times 2 \) matrix whose components are
\begin{subequations}
\begin{align}
  \bra{+1} \mathbb{T} \ket{+1} &= \exp [K+h]  \\
    \bra{+1} \mathbb{T} \ket{-1} &=   \bra{-1} \mathbb{T} \ket{+1} = \exp [-K] \\
      \bra{-1} \mathbb{T} \ket{-1} &=\exp [K-h] 
\end{align}
\end{subequations}
The explicit representation is
\begin{equation}
  \mathbb{T} =
\begin{pmatrix}
e^{K+h}    & e^{-K}  \\
  e^{-K}  & e^{K-h}
\end{pmatrix}
\end{equation}

Let us introduce some useful notations and relations using the bra-ket formalism:
\begin{subequations}
\begin{align}
  \ket{S_i^{(+)}} &= \begin{pmatrix}
  1 \\
  0
  \end{pmatrix}_i
  \quad
  \ket{S_i^{(-)}} = \begin{pmatrix}
  0 \\
  1
  \end{pmatrix}_i   \\
  \bra{S_i^{(+)}} &= (1^*,0)_i \quad   \bra{S_i^{(-)}} = (0,1^*)_i
\end{align}
\end{subequations}
The identity relation is:
\begin{equation}
  \sum_{S_i = \pm 1}^{}  \ket{S_i} \bra{S_i} =
  \ketbra{S_i^{(+)}}{S_i^{(+)}} + \ketbra{S_i^{(-)}}{S_i^{(-)}}
  =\mathbb{1} = \begin{pmatrix}
  1   & 0 \\
  0   & 1
  \end{pmatrix}
\end{equation}
By using the identity property, we can rewrite the partition function as 
\begin{equation}
  \begin{split}
   Z_N (K,h) &= \sum_{S_1 = \pm 1}^{} \dots \sum_{S_N = \pm 1}^{} \bra{S_1} \mathbb{T} \ket{S_2} \bra{S_2}  \mathbb{T} \ket{S_3} \dots \ket{S_i} \bra{S_i}  \mathbb{T} \ket{S_{i+1}} \dots \\
   & = \sum_{S_1 = \pm 1}^{}  \bra{S_1}  \mathbb{T}^N \ket{S_1} = \Tr[\mathbb{T}^N]
     \end{split}
\end{equation}
this is exactly the trace of the matrix, which is most usefully expressed in terms of the eigenvalues. Being \( \mathbb{T} \) symmetric, we can diagonalize it by an unitary transformation as
\begin{equation}
   \mathbb{T}_D = \mathbb{P}^{-1} \mathbb{T} \mathbb{P}
\end{equation}
with \( \mathbb{P} \mathbb{P}^{-1} = \mathbb{1} \). Hence,
\begin{equation*}
\begin{split}
  \Tr[\mathbb{T}^N] &= \Tr[\underbrace{\mathbb{T} \mathbb{T} \mathbb{T} \dots \mathbb{T}}_{N} ] = \Tr[ \mathbb{P} \mathbb{P}^{-1} \mathbb{T} \mathbb{P} \mathbb{P}^{-1} \mathbb{T} \mathbb{P} \dots \mathbb{P}^{-1}  \mathbb{T} \mathbb{P} \mathbb{P}^{-1} ]    \\
  & = \Tr[ \mathbb{P} \mathbb{T}_D^N \mathbb{P}^{-1}] \underset{\substack{ \text{ciclyc property} \\  \text{of the trace} } }{=} \Tr[ \mathbb{T}_D^N \mathbb{P}^{-1} \mathbb{P} ]\\
  & = \Tr[ \mathbb{T}_D^N]
\end{split}
\end{equation*}
where
\begin{equation}
\mathbb{T}_D =  \begin{pmatrix}
  \lambda _+   & 0 \\
  0   & \lambda _-
  \end{pmatrix}
  \quad \Rightarrow \quad
  \mathbb{T}_D^N =  \begin{pmatrix}
    \lambda _+^N   & 0 \\
    0   & \lambda _-^N
    \end{pmatrix}
\end{equation}
with \( \lambda _{\pm} \) are the eigenvalues with \( \lambda _+ > \lambda _- \).
\begin{remark}
\( \mathbb{P} \) is the similitude matrix whose columns are given by the eigenvectors of \(   \lambda _{\pm} \).
\end{remark}
We finally have:
\begin{empheq}[box=\myyellowbox]{equation}
  Z_N (K,h) = \Tr[\mathbb{T_D^N}] = \lambda _+^N  + \lambda _-^N
\end{empheq}
\begin{remark}
As mentioned previously the dimension of the transfer matrix \( \mathbb{T} \) and hence the number of eigenvalues \( \{ \lambda  \}   \) depend both on the possible values of \( S_i \) and on the number of sites involved in terms of the Hamiltonian (range of interaction).
\end{remark}
\begin{example}{}{}
For example, consider the Ising (\( S_i = \pm 1\)) with n. n. and next n. n. interactions. The Hamiltonian is:
\begin{equation*}
  \mathcal{H} = k_1 \sum_{i}^{} S_i S_{i+1} + k_2 \sum_{i}^{} S_i S_{i+1} S_{i+2} S_{i+3}
\end{equation*}
Because of the second term, now there are \( 2^4 = 16 \) possible configurations that can be described by using a \( 4 \times 4 \) transfer matrix that we can write formally as
\begin{equation*}
  \bra{S_i S_{i+1}} \mathbb{T} \ket{S_{i+2} S_{i+3}}
\end{equation*}
\end{example}
\begin{example}{}{}
  For example, suppose \( S_i = +1,0,-1 \), therefore the spin can assume three different values.   This is a \emph{deluted} Ising model.
\end{example}
Now, let us consider the transfer matrix formalism in a more general setting.

\section{General transfer matrix method}
The aim of this section is to describe how transfer matrices can be used to solve classical spin models. The idea is to write down the partition function in terms of a matrix, the transfer matrix. The thermodynamic properties of the model are then wholly described by the eigenspectrum of the matrix. In particular, the free energy per spin in the thermodynamic limit depends only on the largest eigenvalue and the correlation length only on the two largest eigenvalues through simple formulae.

Let \( \mathbb{T} \) be a square matrix \( (n+2) \times (n+2) \) that, for example, it is built if the spin variables mary assume \( (n+2) \) possible values. The \emph{k}-esim value can be defined by the bra-ket notation where the two vectors are given by a sequence of "0" and a single "1" at the \emph{k}-esim  position.
\begin{example}{}{}
If \( k=3 \) and there are \( (n+2) \)  possible values:
  \begin{equation*}
    \bra{S_i^{(3)}} = (0,0,1^*,0,\dots,0) \qquad   \ket{S_i^{(3)}} = \begin{pmatrix}
      0 \\
      0 \\
      1 \\
      \vdots \\
      0
      \end{pmatrix}
  \end{equation*}
these are the bra-ket at the \emph{k}-esim position.
\end{example}
Similarly to the \( 2 \times 2 \) Ising case, it is easy to show the identity property
\begin{equation}
  \sum_{S_i}^{} \ket{S_i} \bra{S_i} = \mathbb{1}, \quad \mathbb{1} \in (n+2)\times(n+2)
\end{equation}
where now the sum is over \( (n+2) \) values.

Let us consider  the \emph{diagonal matrix} \( \mathbb{S}_i \) where the elements along the diagonal are all the  \( (n+2) \) possible values of the \emph{i}-esim spin (or of some of their combination if longer interaction terms are considered)
\begin{equation}
  \mathbb{S}_i \equiv  \sum_{S_i}^{} \ket{S_i} S_i \bra{S_i}
\end{equation}
\begin{example}{}{}
Ising model \( n+2=2 \)
\begin{equation*}
  \begin{pmatrix}
  1 \\
  0
  \end{pmatrix} S^{(1)} (1^*,0) +
  \begin{pmatrix}
  0 \\
  1
  \end{pmatrix} S^{(2)} (0,1^*) =
  \begin{pmatrix}
  S^{(1)}   & 0 \\
  0   & 0
  \end{pmatrix}
  +
  \begin{pmatrix}
  0   & 0 \\
  0   & S^{(2)}
  \end{pmatrix}
  =
  \begin{pmatrix}
  S^{(1)}  & 0 \\
  0   & S^{(2)}
  \end{pmatrix}
\end{equation*}
Ising: \( S^{(1)} =+1,S^{(2)}=-1 \).
\begin{remark}
Note that in this case the matrix \( \mathbb{S}_i \) is equal to the Pauli matrix \( \sigma _z \).
\end{remark}
\end{example}
\begin{remark}
By constrution \( \bra{S_i}  \) and \( \ket{S_i}  \) are the eigenvectors related to the eigenvalues \( S_i = S^{(1)},S^{(2)}, \dots,S^{(n+2)} \).
\end{remark}
Similarly let \( \bra{t_i}  \) and \( \ket{t_i}  \) be the eigenvectors related to the \( (n+2) \) eigenvalues of the transfer matrix \( \mathbb{T} \):
   \( \{ \lambda _+,\lambda _-,\lambda _1,\dots,\lambda _n  \}   \) , with \( \lambda _+ > \lambda _- \ge \lambda _1 \ge \dots \ge \lambda _n \).

Clearly
\begin{equation}
  \mathbb{T} = \mathbb{P} \mathbb{T}_D \mathbb{P}^{-1} = \sum_{i}^{} \ket{t_i} \lambda _i \bra{t_i}
\end{equation}
Indeed,
\begin{equation}
  \mathbb{T} \ket{t_j} = \sum_{i}^{} \ket{t_i} \lambda _i \braket{t_i}{t_j} = \sum_{i}^{}  \ket{t_i} \lambda _i \delta _{ij} = \lambda _j \ket{t_j}
\end{equation}

Given the set of \( \lambda  \) described above, the \emph{N} particle partition function is given by
\begin{equation}
  Z_N ( \{ K \},h  ) = \lambda _+^N +\lambda _-^N + \sum_{i=1}^{n} \lambda _i^{N}
  \label{eq:7_01}
\end{equation}

\subsection{The free energy}

Now, we are interested in the limit of the bulk free energy
\begin{equation}
  F_N () =-k_B T \log{Z_N ()}
\end{equation}
In general, looking at the thermodynamic limit \( N \rightarrow \infty  \), by factorizing \( \lambda _+ \)
\begin{equation}
  f_b ( \{ k \},h  ) = \lim_{N \rightarrow \infty } \frac{1}{N} F_N = \lim_{N \rightarrow \infty } \frac{1}{N} (-k_B T) \log{\qty[\lambda _+^N + \lambda _-^N + \sum_{i=1}^{n} \lambda _i ^N  ] }
\end{equation}
by rearringing,
\begin{equation}
  f_b = \lim_{N \rightarrow \infty } \frac{-k_B T}{N} \log{\qty[\lambda _+^N \qty(1+\frac{\lambda _-^N}{\lambda _+^N}+ \sum_{i=1}^{n} \qty(\frac{\lambda _i}{\lambda _+})^N    ) ] }
\end{equation}
Since \( \lambda _+ > \lambda _- > \lambda _1 > \dots \lambda _n \),
\begin{equation}
\qty(\frac{\lambda _-}{\lambda _+})^N \overset{N \rightarrow \infty }{\longrightarrow} 0,
\quad
\qty(\frac{\lambda _i}{\lambda _+})^N \overset{N \rightarrow \infty }{\longrightarrow} 0
\quad \forall i
\end{equation}
we obtain:
\begin{empheq}[box=\myyellowbox]{equation}
f_b = -k_B T \log{\lambda _+}
\end{empheq}
The limiting free-energy depends only on the largest eigenvalue of the transfer matrix \( \mathbb{T} \)! This is important since sometimes it is much simpler to compute only the largest eigenvalue than the whole spectrum of \( \mathbb{T} \). Also an important theorem about \( \lambda _+ \) exists.

  \begin{theorem}{Perron-Frobenius}{}
  Let \( \mathbb{A} \) be a \( n \times n \) matrix. If \( \mathbb{A} \) is finite (\( n < \infty  \)) and \( \mathbb{A}_{ij} > 0 , \forall i,j \), \( (\mathbb{A}_{ij}=\mathbb{A}_{ij} (\va{x})) \), therefore its largest eigenvalue \( \lambda _+ \) has the following properties:
  \begin{enumerate}
  \item \( \lambda _+ \in \R^+  \)
  \item \( \lambda _+ \neq \text{ from } \{ \lambda _i \}_{i=1,\dots, n-1 }   \). It means there is no degeneracy.
  \item \( \lambda _+ \) is a analytic function of the parameters of \( \mathbb{A} \).
  \end{enumerate}
  \end{theorem}

\begin{remark}
Since in our case \( \mathbb{A} \leftrightarrow  \mathbb{T} \), \( \lambda _+ \) is related to \( f_b \) from the theorem. This means that \( f_b \) is an analytic function!
\end{remark}
\begin{remark}
This is true for \( T>0 \) since for \( T=0 \) some \( \mathbb{T}_{ij} \) can be either 0 or \( \infty  \) violating the hypothesis of the theorem.
\end{remark}
\begin{remark}
If \( \mathbb{T} \) has infinite dimension (see \( d>1 \)) the hypothesis of the theorem are not valid any more and \( f_b \) can be non-analytic.
\end{remark}
If the conditions of the Perron-Frobenius theorem are satisfied by \( \mathbb{T} \), the model described by  \( \mathbb{T} \) cannot display a phase transition!

\subsection{The correlation function}
A second important quantity which is simply related to the eigenvalues of the transfer matrix is the correlation length. To calculate this we need the spin-spin correlation function which serves as an example of how to obtain averages of products of spins using transfer matrices.

Let us consider the two point correlation between two spins at distance \emph{R} to another. The fluctuation respect to the average is:
\begin{equation}
  \Gamma _R \equiv  \expval{S_1 S_R} - \expval{S_1}\expval{S_R}
\end{equation}
Since
\begin{equation}
  \Gamma _R \underset{R \rightarrow \infty }{\sim } \exp [-R/\xi ]
\end{equation}
we can define the correlation length \( \xi  \) as
\begin{equation}
  \xi^{-1} \equiv  \lim_{R \rightarrow \infty } \qty[ - \frac{1}{R} \log{ \qty| \expval{S_1 S_R} - \expval{S_1}\expval{S_R}| } ]
  \label{eq:7_2}
\end{equation}

Now, let us compute the terms \( \expval{S_1 S_R}_N  \) and \( \expval{S_1}_N\expval{S_R}_N \).
From the definition of average we obtain
\begin{equation}
  \expval{S_1 S_R}_N = \frac{1}{Z_N} \sum_{\{ S \}  }^{} S_1 S_R \exp [-\beta \mathcal{H}_N]
\end{equation}
\begin{remark}
The subscript \( N \) denotes that we are again considering a ring of \( N \) spins. \( Z_N \) is known from equation \eqref{eq:7_01}.
\end{remark}
Writing this expression by using the transfer matrix formalism one obtains
\begin{equation}
\expval{S_1 S_R}_N  = \frac{1}{Z_N} \sum_{\{ S \}  }^{} S_1 \bra{S_1} \mathbb{T} \ket{S_2} \dots  \bra{S_{R-1}} \mathbb{T} \ket{S_R} S_R \bra{S_R} \mathbb{T} \ket{S_{R+1}} \dots \bra{S_N} \mathbb{T} \ket{S_1}
\end{equation}
Summing over the free spins,
\begin{equation}
  \expval{S_1 S_R}_N = \frac{1}{Z_N} \sum_{S_1,S_R}^{} S_1 \bra{S_1} \mathbb{T}^{R-1} \ket{S_R} S_R \bra{S_R} \mathbb{T}^{N-R+1} \ket{S_1}
  \label{eq:7_1}
\end{equation}
On the other hand, since
\begin{equation}
  \mathbb{T} = \sum_{i=1}^{n+2} \ket{t_i} \lambda _i  \bra{t_i}
\end{equation}
we have
\begin{subequations}
\begin{align}
  \mathbb{T}^{R-1} &= \sum_{i=1}^{n+2} \ket{t_i} \lambda _i^{R-1}  \bra{t_i} \\
    \mathbb{T}^{N-R+1} &= \sum_{i=1}^{n+2} \ket{t_i} \lambda _i^{N-R+1}  \bra{t_i}
\end{align}
\end{subequations}
Hence,
\begin{equation}
  \bra{S_1} \mathbb{T}^{R-1} \ket{S_R} = \sum_{i=1}^{n+2} \braket{S_1}{t_i} \lambda_i ^{R-1} \braket{t_i}{S_R}
\end{equation}
and plugging this expression in  \eqref{eq:7_1} one gets
\begin{equation}
  \sum_{\{ S \}  }^{}  S_1 S_R e^{-\beta \mathcal{H}_N} = \sum_{S_1 S_R}^{} S_1 \sum_{i=1}^{n+2} \braket{S_1}{t_i} \lambda _i^{R-1} \braket{t_i}{S_R} S_R \sum_{j=1}^{n+2} \braket{S_R}{t_j} \lambda_j ^{N-R+1} \braket{t_j}{S_1}
\end{equation}
Since the term \( \braket{t_j}{S_1}  \) is a scalar it can be moved at the beginning of the product. Remembering the notations
\begin{subequations}
\begin{align}
  \mathbb{S}_1 &= \sum_{S_1}^{} \ket{S_1} S_1 \bra{S_1} \\
  \mathbb{S}_R &= \sum_{S_R}^{} \ket{S_R} S_R \bra{S_R}
\end{align}
\end{subequations}
one gets
\begin{equation}
  \sum_{\{ S \}  }^{}  S_1 S_R e^{-\beta \mathcal{H}_N}= \sum_{ij}^{} \bra{t_j } \mathbb{S}_1 \ket{t_i} \lambda _i^{R-1} \bra{t_i} \mathbb{S}_R \ket{t_j} \lambda _j ^{N-R+1}
\end{equation}















\end{document}
